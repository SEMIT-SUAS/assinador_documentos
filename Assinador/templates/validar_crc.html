<!DOCTYPE html>
<html lang="pt-br" data-theme="light">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Verifica√ß√£o por CRC</title>

  <!-- Bootstrap -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" />
  <!-- Bootstrap Icons (necess√°rio para o √≠cone da seta Voltar) -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet" />
</head>

<style>
  /* fundo suave e tipografia */
  body {
    background: linear-gradient(180deg, #f6faff 0%, #ffffff 120%);
  }

  /* logo do selo */
  .crc-logo { height: 56px; width: auto; }

  /* card base */
  .crc-card,
  .crc-feature {
    border: 1px solid #eef2f6;
    border-radius: 14px;
    box-shadow: 0 10px 30px -20px rgba(20, 30, 50, .25);
  }

  /* input grande mais macio */
  .input-group-lg > .form-control,
  .input-group-lg > .btn {
    border-radius: 12px;
  }

  /* alerta com borda suave */
  .crc-soft-alert {
    background: #fff7e6;
    border-color: #ffe1a7;
  }
  .crc-alert-icon {
    width: 34px; height: 34px;
    border-radius: 999px;
    display: grid; place-items: center;
    background: #fff1c4; color: #a15b00;
  }

  /* √≠cones redondos dos recursos */
  .crc-feature-icon {
    width: 44px; height: 44px;
    border-radius: 999px;
    display: grid; place-items: center;
    font-weight: 700;
  }
  .crc-ok { background: #e8f7ef; color: #198754; }
  .crc-blue { background: #e8f1ff; color: #0d6efd; }
  .crc-purple { background: #f2e9ff; color: #6f42c1; }

  /* hover sutil nos cards */
  .crc-feature.card:hover {
    transform: translateY(-2px);
    transition: transform .15s ease;
  }

  /* moldura da pr√©via */
  .crc-preview iframe {
    border: 1px solid #e5e7eb;
  }

  /* responsividade do t√≠tulo */
  @media (max-width: 576px) {
    .crc-logo { display:none; }
  }
</style>

<body class="min-vh-100 d-flex flex-column">
  <!-- Header -->
  <header class="app-header">
    <div class="py-3">
      <div class="d-flex align-items-center justify-content-between mx-5">
        <div class="d-flex align-items-center gap-3">
          <a href="{{ url_for('verificar') }}" class="btn btn-outline-secondary btn-sm" aria-label="Voltar para login">
            <i class="bi bi-arrow-left"></i> <span class="d-none d-sm-inline">Voltar</span>
          </a>
          <div>
            <h1 class="h3 mb-0 fw-semibold">Valida√ß√£o por CRC</h1>
          </div>
        </div>
        <img
          class="brand-logo"
          src="{{ url_for('static', filename='img/logo_selo.png') }}"
          alt="Selo de Autentica√ß√£o Eletr√¥nica da Prefeitura de S√£o Lu√≠s"
          height="64"
          loading="eager"
          decoding="async"
        />
      </div>
    </div>
  </header>

  <!-- Conte√∫do -->
  <div class="crc-page container py-4 flex-grow-1"><!-- <- garante que o conte√∫do ocupe o espa√ßo -->
    {% if erro %}
      <div class="alert alert-danger shadow-sm">{{ erro }}</div>
    {% endif %}

    <p class="text-muted mb-3">
      Informe o CRC abaixo para exibir a c√≥pia oficial e, se desejar, comparar um arquivo.
    </p>

    <!-- CARD BUSCA -->
    <div class="card crc-card mb-4">
      <div class="card-body">
        <form method="GET" action="{{ url_for('validar_crc') }}">
          <label class="form-label fw-semibold" for="crc">C√≥digo CRC</label>
          <div class="input-group input-group-lg">
            <input id="crc" name="crc" class="form-control" type="text"
                   placeholder="ex.: a1b2c3d4e5" value="{{ crc or '' }}" required>
            <button class="btn btn-primary px-4" type="submit">
              <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" fill="currentColor" class="me-1" viewBox="0 0 16 16" aria-hidden="true">
                <path d="M11.742 10.344a6.5 6.5 0 1 0-1.397 1.398h-.001l3.85 3.85a1 1 0 0 0 1.415-1.415l-3.85-3.85zM12 6.5a5.5 5.5 0 1 1-11 0 5.5 5.5 0 0 1 11 0"/>
              </svg>
              Buscar
            </button>
          </div>
        </form>
      </div>
    </div>

    <!-- AVISO QUANDO AINDA N√ÉO H√Å RESULTADO -->
    {% if not caminho and not erro %}
      <div class="alert alert-warning d-flex align-items-start gap-3 shadow-sm crc-soft-alert" role="alert">
        <div class="crc-alert-icon">
          <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-exclamation-triangle" viewBox="0 0 16 16">
  <path d="M7.938 2.016A.13.13 0 0 1 8.002 2a.13.13 0 0 1 .063.016.15.15 0 0 1 .054.057l6.857 11.667c.036.06.035.124.002.183a.2.2 0 0 1-.054.06.1.1 0 0 1-.066.017H1.146a.1.1 0 0 1-.066-.017.2.2 0 0 1-.054-.06.18.18 0 0 1 .002-.183L7.884 2.073a.15.15 0 0 1 .054-.057m1.044-.45a1.13 1.13 0 0 0-1.96 0L.165 13.233c-.457.778.091 1.767.98 1.767h13.713c.889 0 1.438-.99.98-1.767z"/>
  <path d="M7.002 12a1 1 0 1 1 2 0 1 1 0 0 1-2 0M7.1 5.995a.905.905 0 1 1 1.8 0l-.35 3.507a.552.552 0 0 1-1.1 0z"/>
</svg>
        </div>
        <div>
          <strong>Aviso</strong><br>
          A verifica√ß√£o confere autenticidade e integridade do documento digital, garantindo que ele n√£o foi alterado desde a emiss√£o.
          Ao comparar o CRC, voc√™ confirma que o arquivo √© id√™ntico √† c√≥pia oficial registrada.
        </div>
      </div>

      <!-- BENEF√çCIOS -->
      <div class="row g-3 mt-3">
        <div class="col-12 col-md-4">
          <div class="crc-feature card h-100">
            <div class="card-body">
              <div class="crc-feature-icon crc-ok mb-2">‚úì</div>
              <h6 class="fw-bold mb-1">Verifica√ß√£o Segura</h6>
              <p class="text-muted mb-0">Sistema de confer√™ncia com criptografia avan√ßada.</p>
            </div>
          </div>
        </div>
        <div class="col-12 col-md-4">
          <div class="crc-feature card h-100">
            <div class="card-body">
              <div class="crc-feature-icon crc-blue mb-2">üõ°Ô∏è</div>
              <h6 class="fw-bold mb-1">Integridade</h6>
              <p class="text-muted mb-0">Confirma que o documento n√£o foi alterado desde a emiss√£o.</p>
            </div>
          </div>
        </div>
        <div class="col-12 col-md-4">
          <div class="crc-feature card h-100">
            <div class="card-body">
              <div class="crc-feature-icon crc-purple mb-2">üìÑ</div>
              <h6 class="fw-bold mb-1">Autenticidade</h6>
              <p class="text-muted mb-0">Valida a origem oficial do documento digital.</p>
            </div>
          </div>
        </div>
      </div>
    {% endif %}

    <!-- RESULTADO / PR√âVIA -->
    {% if caminho %}
      <div class="card crc-card mb-3">
        <div class="card-header bg-white fw-semibold">C√≥pia oficial localizada</div>
        <div class="card-body">
          <div class="d-flex flex-wrap gap-2 mb-3">
            <a class="btn btn-outline-primary" href="{{ caminho }}" target="_blank" rel="noopener">Abrir no navegador</a>
            <a class="btn btn-outline-secondary" href="{{ caminho }}" download>Baixar arquivo</a>
          </div>

          <div class="ratio ratio-4x3 crc-preview">
            <iframe src="{{ caminho }}" title="C√≥pia oficial" class="rounded"></iframe>
          </div>

          {% if match is not none %}
            {% if match %}
              <div class="alert alert-success mt-3 mb-0 text-center shadow-sm">‚úî Arquivo √≠ntegro: id√™ntico √† c√≥pia oficial.</div>
            {% else %}
              <div class="alert alert-danger  mt-3 mb-0 text-center shadow-sm">‚úñ Arquivo ALTERADO: n√£o coincide com a c√≥pia oficial.</div>
            {% endif %}
          {% endif %}
        </div>
      </div>

      {# Bloco de compara√ß√£o por upload (opcional) #}
      {#
      <div class="card crc-card">
        <div class="card-header bg-white fw-semibold">Comparar minha c√≥pia (upload)</div>
        <div class="card-body">
          <form method="POST" enctype="multipart/form-data" action="{{ url_for('validar_crc') }}" class="row g-2 align-items-center">
            <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
            <input type="hidden" name="acao" value="comparar">
            <input type="hidden" name="crc"  value="{{ crc or '' }}">
            <div class="col-12 col-md-8">
              <input type="file" name="arquivo" class="form-control" required>
            </div>
            <div class="col-12 col-md-4 col-lg-3 ms-auto">
              <button class="btn btn-success w-100" type="submit">Comparar com a oficial</button>
            </div>
          </form>
        </div>
      </div>
      #}
    {% endif %}
  </div>

  <!-- Footer -->
  <footer class="border-top mt-auto"><!-- <- mt-auto empurra o footer para o fim -->
    <div class="container py-3 d-flex justify-content-center align-items-center">
      <small class="text-secondary">
        ¬© {{ 2025 }} Prefeitura de S√£o Lu√≠s ‚Äî Secretaria Municipal de Informa√ß√£o e Tecnologia
      </small>
    </div>
  </footer>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
